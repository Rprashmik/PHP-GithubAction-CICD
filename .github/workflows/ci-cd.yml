name: CI/CD Deploy Laravel

on:
  push:
    branches: ["main"]

jobs:
  deploy:
    runs-on: self-hosted   # ðŸ‘ˆ SELF-HOSTED RUNNER USE

    steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Go to App Directory
      run: cd /home/rashmik.parmar/www/PHP-GithubAction-CICD/laravel-app

    - name: Build & Restart Docker
      run: |
        cd /home/rashmik.parmar/www/PHP-GithubAction-CICD/laravel-app
        git pull origin main || true
        docker-compose down || true
        docker-compose up -d --build
